<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Management System</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 5px;
        }
        
        h1 {
            margin: 0;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background-color: #ecf0f1;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background-color: #bdc3c7;
            border: none;
            flex: 1;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .tab.active {
            background-color: #3498db;
            color: white;
        }
        
        .tab:hover:not(.active) {
            background-color: #95a5a6;
            color: white;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #3498db;
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .action-btns button {
            padding: 5px 10px;
            margin-right: 5px;
        }
        
        .edit-btn {
            background-color: #f39c12;
        }
        
        .edit-btn:hover {
            background-color: #e67e22;
        }
        
        .delete-btn {
            background-color: #e74c3c;
        }
        
        .delete-btn:hover {
            background-color: #c0392b;
        }
        
        .search-container {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        
        .search-container input {
            flex: 1;
        }
        
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            display: none;
        }
        
        .alert.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .stats-cards {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            flex: 1;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-card h3 {
            margin-top: 0;
            color: #7f8c8d;
        }
        
        .stat-card .value {
            font-size: 36px;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Patient Management System</h1>
        </header>
        
        <div class="stats-cards">
            <div class="stat-card">
                <h3>Total Patients</h3>
                <div class="value" id="total-patients">0</div>
            </div>
            <div class="stat-card">
                <h3>Active Appointments</h3>
                <div class="value" id="active-appointments">0</div>
            </div>
            <div class="stat-card">
                <h3>Today's Visits</h3>
                <div class="value" id="todays-visits">0</div>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="openTab(event, 'patients')">Patients</button>
            <button class="tab" onclick="openTab(event, 'appointments')">Appointments</button>
            <button class="tab" onclick="openTab(event, 'add-patient')">Add Patient</button>
            <button class="tab" onclick="openTab(event, 'reports')">Reports</button>
        </div>
        
        <div id="alert-message" class="alert"></div>
        
        <!-- Patients Tab -->
        <div id="patients" class="tab-content active">
            <div class="search-container">
                <input type="text" id="patient-search" placeholder="Search patients by name, ID, or phone..." onkeyup="searchPatients()">
                <button onclick="searchPatients()">Search</button>
            </div>
            
            <table id="patients-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Age</th>
                        <th>Gender</th>
                        <th>Phone</th>
                        <th>Last Visit</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="patients-list">
                    <!-- Patients will be added here dynamically -->
                </tbody>
            </table>
        </div>
        
        <!-- Appointments Tab -->
        <div id="appointments" class="tab-content">
            <div class="search-container">
                <input type="date" id="appointment-date">
                <button onclick="filterAppointments()">Filter</button>
                <button onclick="resetAppointmentFilter()">Reset</button>
            </div>
            
            <table id="appointments-table">
                <thead>
                    <tr>
                        <th>Patient</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Reason</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="appointments-list">
                    <!-- Appointments will be added here dynamically -->
                </tbody>
            </table>
        </div>
        
        <!-- Add Patient Tab -->
        <div id="add-patient" class="tab-content">
            <form id="patient-form" onsubmit="addPatient(event)">
                <div class="form-group">
                    <label for="first-name">First Name</label>
                    <input type="text" id="first-name" required>
                </div>
                
                <div class="form-group">
                    <label for="last-name">Last Name</label>
                    <input type="text" id="last-name" required>
                </div>
                
                <div class="form-group">
                    <label for="dob">Date of Birth</label>
                    <input type="date" id="dob" required>
                </div>
                
                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select id="gender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email">
                </div>
                
                <div class="form-group">
                    <label for="address">Address</label>
                    <textarea id="address" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="medical-history">Medical History</label>
                    <textarea id="medical-history" rows="3"></textarea>
                </div>
                
                <button type="submit">Add Patient</button>
            </form>
        </div>
        
        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="form-group">
                <label for="report-type">Report Type</label>
                <select id="report-type" onchange="updateReportParams()">
                    <option value="patient-list">Patient List</option>
                    <option value="appointments-by-date">Appointments by Date Range</option>
                    <option value="patient-visits">Patient Visits</option>
                </select>
            </div>
            
            <div id="report-params">
                <!-- Parameters will be added here dynamically based on report type -->
            </div>
            
            <button onclick="generateReport()">Generate Report</button>
            
            <div id="report-results" style="margin-top: 20px;">
                <!-- Report results will be displayed here -->
            </div>
        </div>
    </div>

    <script>
        // Sample data storage (in a real app, this would be replaced with API calls)
        let patients = [
            {
                id: 1,
                firstName: "John",
                lastName: "Doe",
                dob: "1985-05-15",
                gender: "Male",
                phone: "555-123-4567",
                email: "john.doe@example.com",
                address: "123 Main St, Anytown, USA",
                medicalHistory: "Hypertension, Allergic to penicillin",
                lastVisit: "2023-05-10"
            },
            {
                id: 2,
                firstName: "Jane",
                lastName: "Smith",
                dob: "1990-08-22",
                gender: "Female",
                phone: "555-987-6543",
                email: "jane.smith@example.com",
                address: "456 Oak Ave, Somewhere, USA",
                medicalHistory: "Asthma, Diabetes type 2",
                lastVisit: "2023-06-15"
            }
        ];
        
        let appointments = [
            {
                id: 1,
                patientId: 1,
                patientName: "John Doe",
                date: "2023-07-20",
                time: "10:00",
                reason: "Annual checkup",
                status: "Scheduled"
            },
            {
                id: 2,
                patientId: 2,
                patientName: "Jane Smith",
                date: "2023-07-21",
                time: "14:30",
                reason: "Follow-up for diabetes",
                status: "Scheduled"
            }
        ];
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            renderPatients();
            renderAppointments();
        });
        
        // Tab functionality
        function openTab(evt, tabName) {
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }
        
        // Update statistics
        function updateStats() {
            document.getElementById('total-patients').textContent = patients.length;
            
            const today = new Date().toISOString().split('T')[0];
            const todaysVisits = appointments.filter(a => a.date === today).length;
            document.getElementById('todays-visits').textContent = todaysVisits;
            
            const activeAppointments = appointments.filter(a => a.status === 'Scheduled').length;
            document.getElementById('active-appointments').textContent = activeAppointments;
        }
        
        // Render patients table
        function renderPatients() {
            const tbody = document.getElementById('patients-list');
            tbody.innerHTML = '';
            
            patients.forEach(patient => {
                const age = calculateAge(patient.dob);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${patient.id}</td>
                    <td>${patient.firstName} ${patient.lastName}</td>
                    <td>${age}</td>
                    <td>${patient.gender}</td>
                    <td>${patient.phone}</td>
                    <td>${patient.lastVisit || 'N/A'}</td>
                    <td class="action-btns">
                        <button class="edit-btn" onclick="editPatient(${patient.id})">Edit</button>
                        <button class="delete-btn" onclick="deletePatient(${patient.id})">Delete</button>
                        <button onclick="viewPatientDetails(${patient.id})">View</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Calculate age from date of birth
        function calculateAge(dob) {
            const birthDate = new Date(dob);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            
            return age;
        }
        
        // Render appointments table
        function renderAppointments() {
            const tbody = document.getElementById('appointments-list');
            tbody.innerHTML = '';
            
            appointments.forEach(appointment => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${appointment.patientName}</td>
                    <td>${appointment.date}</td>
                    <td>${appointment.time}</td>
                    <td>${appointment.reason}</td>
                    <td>${appointment.status}</td>
                    <td class="action-btns">
                        <button onclick="editAppointment(${appointment.id})">Edit</button>
                        <button class="delete-btn" onclick="cancelAppointment(${appointment.id})">Cancel</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Search patients
        function searchPatients() {
            const searchTerm = document.getElementById('patient-search').value.toLowerCase();
            const filteredPatients = patients.filter(patient => {
                return (
                    patient.firstName.toLowerCase().includes(searchTerm) ||
                    patient.lastName.toLowerCase().includes(searchTerm) ||
                    patient.phone.includes(searchTerm) ||
                    patient.id.toString().includes(searchTerm)
                );
            });
            
            const tbody = document.getElementById('patients-list');
            tbody.innerHTML = '';
            
            filteredPatients.forEach(patient => {
                const age = calculateAge(patient.dob);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${patient.id}</td>
                    <td>${patient.firstName} ${patient.lastName}</td>
                    <td>${age}</td>
                    <td>${patient.gender}</td>
                    <td>${patient.phone}</td>
                    <td>${patient.lastVisit || 'N/A'}</td>
                    <td class="action-btns">
                        <button class="edit-btn" onclick="editPatient(${patient.id})">Edit</button>
                        <button class="delete-btn" onclick="deletePatient(${patient.id})">Delete</button>
                        <button onclick="viewPatientDetails(${patient.id})">View</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Filter appointments by date
        function filterAppointments() {
            const date = document.getElementById('appointment-date').value;
            
            if (!date) {
                renderAppointments();
                return;
            }
            
            const filteredAppointments = appointments.filter(a => a.date === date);
            
            const tbody = document.getElementById('appointments-list');
            tbody.innerHTML = '';
            
            filteredAppointments.forEach(appointment => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${appointment.patientName}</td>
                    <td>${appointment.date}</td>
                    <td>${appointment.time}</td>
                    <td>${appointment.reason}</td>
                    <td>${appointment.status}</td>
                    <td class="action-btns">
                        <button onclick="editAppointment(${appointment.id})">Edit</button>
                        <button class="delete-btn" onclick="cancelAppointment(${appointment.id})">Cancel</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Reset appointment filter
        function resetAppointmentFilter() {
            document.getElementById('appointment-date').value = '';
            renderAppointments();
        }
        
        // Add new patient
        function addPatient(event) {
            event.preventDefault();
            
            const newPatient = {
                id: patients.length > 0 ? Math.max(...patients.map(p => p.id)) + 1 : 1,
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                dob: document.getElementById('dob').value,
                gender: document.getElementById('gender').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                medicalHistory: document.getElementById('medical-history').value,
                lastVisit: null
            };
            
            patients.push(newPatient);
            renderPatients();
            updateStats();
            document.getElementById('patient-form').reset();
            
            showAlert('Patient added successfully!', 'success');
            
            // Switch to patients tab
            document.querySelector('.tab[onclick*="patients"]').click();
        }
        
        // Edit patient
        function editPatient(id) {
            const patient = patients.find(p => p.id === id);
            if (!patient) return;
            
            // In a real app, this would open a modal or form with the patient data
            showAlert(`Editing patient: ${patient.firstName} ${patient.lastName} (ID: ${id})`, 'success');
        }
        
        // View patient details
        function viewPatientDetails(id) {
            const patient = patients.find(p => p.id === id);
            if (!patient) return;
            
            // In a real app, this would open a modal with detailed patient info
            const age = calculateAge(patient.dob);
            const details = `
                <h3>${patient.firstName} ${patient.lastName} (${age} years)</h3>
                <p><strong>Gender:</strong> ${patient.gender}</p>
                <p><strong>Phone:</strong> ${patient.phone}</p>
                <p><strong>Email:</strong> ${patient.email || 'N/A'}</p>
                <p><strong>Address:</strong> ${patient.address || 'N/A'}</p>
                <p><strong>Medical History:</strong> ${patient.medicalHistory || 'None recorded'}</p>
                <p><strong>Last Visit:</strong> ${patient.lastVisit || 'No visits recorded'}</p>
            `;
            
            showAlert(details, 'success');
        }
        
        // Delete patient
        function deletePatient(id) {
            if (confirm('Are you sure you want to delete this patient?')) {
                patients = patients.filter(p => p.id !== id);
                renderPatients();
                updateStats();
                showAlert('Patient deleted successfully!', 'success');
            }
        }
        
        // Edit appointment
        function editAppointment(id) {
            const appointment = appointments.find(a => a.id === id);
            if (!appointment) return;
            
            showAlert(`Editing appointment for ${appointment.patientName} on ${appointment.date} at ${appointment.time}`, 'success');
        }
        
        // Cancel appointment
        function cancelAppointment(id) {
            if (confirm('Are you sure you want to cancel this appointment?')) {
                const index = appointments.findIndex(a => a.id === id);
                if (index !== -1) {
                    appointments[index].status = 'Cancelled';
                    renderAppointments();
                    showAlert('Appointment cancelled!', 'success');
                }
            }
        }
        
        // Update report parameters based on selected type
        function updateReportParams() {
            const reportType = document.getElementById('report-type').value;
            const paramsDiv = document.getElementById('report-params');
            
            switch(reportType) {
                case 'patient-list':
                    paramsDiv.innerHTML = `
                        <div class="form-group">
                            <label for="patient-sort">Sort By</label>
                            <select id="patient-sort">
                                <option value="name">Name</option>
                                <option value="id">Patient ID</option>
                                <option value="last-visit">Last Visit Date</option>
                            </select>
                        </div>
                    `;
                    break;
                    
                case 'appointments-by-date':
                    paramsDiv.innerHTML = `
                        <div class="form-group">
                            <label for="start-date">Start Date</label>
                            <input type="date" id="start-date" required>
                        </div>
                        <div class="form-group">
                            <label for="end-date">End Date</label>
                            <input type="date" id="end-date" required>
                        </div>
                        <div class="form-group">
                            <label for="appointment-status">Status</label>
                            <select id="appointment-status">
                                <option value="all">All</option>
                                <option value="Scheduled">Scheduled</option>
                                <option value="Completed">Completed</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        </div>
                    `;
                    break;
                    
                case 'patient-visits':
                    paramsDiv.innerHTML = `
                        <div class="form-group">
                            <label for="patient-id">Patient ID</label>
                            <input type="number" id="patient-id" placeholder="Enter patient ID">
                        </div>
                        <div class="form-group">
                            <label for="visits-period">Period</label>
                            <select id="visits-period">
                                <option value="all">All time</option>
                                <option value="year">Last year</option>
                                <option value="month">Last month</option>
                                <option value="week">Last week</option>
                            </select>
                        </div>
                    `;
                    break;
            }
        }
        
        // Generate report
        function generateReport() {
            const reportType = document.getElementById('report-type').value;
            const resultsDiv = document.getElementById('report-results');
            
            switch(reportType) {
                case 'patient-list':
                    const sortBy = document.getElementById('patient-sort').value;
                    let sortedPatients = [...patients];
                    
                    if (sortBy === 'name') {
                        sortedPatients.sort((a, b) => `${a.lastName} ${a.firstName}`.localeCompare(`${b.lastName} ${b.firstName}`));
                    } else if (sortBy === 'id') {
                        sortedPatients.sort((a, b) => a.id - b.id);
                    } else if (sortBy === 'last-visit') {
                        sortedPatients.sort((a, b) => new Date(b.lastVisit || 0) - new Date(a.lastVisit || 0));
                    }
                    
                    let html = '<h3>Patient List Report</h3>';
                    html += '<table><thead><tr><th>ID</th><th>Name</th><th>Age</th><th>Gender</th><th>Phone</th><th>Last Visit</th></tr></thead><tbody>';
                    
                    sortedPatients.forEach(patient => {
                        const age = calculateAge(patient.dob);
                        html += `
                            <tr>
                                <td>${patient.id}</td>
                                <td>${patient.firstName} ${patient.lastName}</td>
                                <td>${age}</td>
                                <td>${patient.gender}</td>
                                <td>${patient.phone}</td>
                                <td>${patient.lastVisit || 'N/A'}</td>
                            </tr>
                        `;
                    });
                    
                    html += '</tbody></table>';
                    resultsDiv.innerHTML = html;
                    break;
                    
                case 'appointments-by-date':
                    const startDate = document.getElementById('start-date').value;
                    const endDate = document.getElementById('end-date').value;
                    const status = document.getElementById('appointment-status').value;
                    
                    if (!startDate || !endDate) {
                        showAlert('Please select both start and end dates', 'error');
                        return;
                    }
                    
                    let filteredAppointments = appointments.filter(a => {
                        return a.date >= startDate && a.date <= endDate;
                    });
                    
                    if (status !== 'all') {
                        filteredAppointments = filteredAppointments.filter(a => a.status === status);
                    }
                    
                    html = `<h3>Appointments Report (${startDate} to ${endDate})</h3>`;
                    html += '<table><thead><tr><th>Date</th><th>Time</th><th>Patient</th><th>Reason</th><th>Status</th></tr></thead><tbody>';
                    
                    filteredAppointments.forEach(app => {
                        html += `
                            <tr>
                                <td>${app.date}</td>
                                <td>${app.time}</td>
                                <td>${app.patientName}</td>
                                <td>${app.reason}</td>
                                <td>${app.status}</td>
                            </tr>
                        `;
                    });
                    
                    html += '</tbody></table>';
                    resultsDiv.innerHTML = html;
                    break;
                    
                case 'patient-visits':
                    const patientId = document.getElementById('patient-id').value;
                    const period = document.getElementById('visits-period').value;
                    
                    if (!patientId) {
                        showAlert('Please enter a patient ID', 'error');
                        return;
                    }
                    
                    const patient = patients.find(p => p.id === parseInt(patientId));
                    if (!patient) {
                        showAlert('Patient not found', 'error');
                        return;
                    }
                    
                    // In a real app, this would pull from a visits database
                    const visits = [
                        { date: '2023-06-15', reason: 'Follow-up for diabetes', doctor: 'Dr. Smith' },
                        { date: '2023-05-10', reason: 'Annual checkup', doctor: 'Dr. Johnson' },
                        { date: '2023-03-22', reason: 'Blood test results', doctor: 'Dr. Smith' }
                    ].filter(v => {
                        if (period === 'all') return true;
                        
                        const visitDate = new Date(v.date);
                        const today = new Date();
                        const diffTime = today - visitDate;
                        const diffDays = diffTime / (1000 * 60 * 60 * 24);
                        
                        if (period === 'year') return diffDays <= 365;
                        if (period === 'month') return diffDays <= 30;
                        if (period === 'week') return diffDays <= 7;
                        return true;
                    });
                    
                    html = `<h3>Patient Visits Report for ${patient.firstName} ${patient.lastName} (ID: ${patient.id})</h3>`;
                    
                    if (visits.length === 0) {
                        html += '<p>No visits found for the selected criteria</p>';
                    } else {
                        html += '<table><thead><tr><th>Date</th><th>Reason</th><th>Doctor</th></tr></thead><tbody>';
                        
                        visits.forEach(v => {
                            html += `
                                <tr>
                                    <td>${v.date}</td>
                                    <td>${v.reason}</td>
                                    <td>${v.doctor}</td>
                                </tr>
                            `;
                        });
                        
                        html += '</tbody></table>';
                    }
                    
                    resultsDiv.innerHTML = html;
                    break;
            }
        }
        
        // Show alert message
        function showAlert(message, type) {
            const alertDiv = document.getElementById('alert-message');
            alertDiv.innerHTML = message;
            alertDiv.className = 'alert ' + type;
            alertDiv.style.display = 'block';
            
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>